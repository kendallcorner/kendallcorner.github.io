<!DOCTYPE html>
<html lang=en>
<head>
<meta http-equiv="Content-Security-Policy" content="default-src https:">
</head>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="I recently created a TOR relay on a raspberry pi at home. It sits quietly next to my router supporting free speech and privacy and costing my nothing daily. Here’s how I did it.  I bought a raspbery p">
<meta property="og:type" content="article">
<meta property="og:title" content="Start a TOR relay at home on a Raspberry Pi">
<meta property="og:url" content="http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/index.html">
<meta property="og:site_name" content="kendallcorner">
<meta property="og:description" content="I recently created a TOR relay on a raspberry pi at home. It sits quietly next to my router supporting free speech and privacy and costing my nothing daily. Here’s how I did it.  I bought a raspbery p">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-10-11T18:45:49.000Z">
<meta property="article:modified_time" content="2020-10-11T21:18:57.422Z">
<meta property="article:author" content="Kendall Werts">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="https://www.gravatar.com/avatar/6c523d558ab10db7e2c1f3025dc898e9?s=16">
          
        
        
          
            <link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/6c523d558ab10db7e2c1f3025dc898e9?s=192" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Start a TOR relay at home on a Raspberry Pi</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="kendallcorner" type="application/atom+xml">
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/posts/">Writing</a></li>
         
          <li><a href="http://github.com/kendallcorner" target="_blank" rel="noopener">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2019/12/29/Mozilla-HG/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/" target="_blank" rel="noopener"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&text=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&is_video=false&description=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Start a TOR relay at home on a Raspberry Pi&body=Check out this article: http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&name=Start a TOR relay at home on a Raspberry Pi&description=" target="_blank" rel="noopener"><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Start a TOR relay at home on a Raspberry Pi
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">kendallcorner</span>
      </span>
      
    <div class="postdate">
        <time datetime="2020-10-11T18:45:49.000Z" itemprop="datePublished">2020-10-11</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>I recently created a TOR relay on a raspberry pi at home. It sits quietly next to my router supporting free speech and privacy and costing my nothing daily.</p>
<p>Here’s how I did it.</p>
<ol>
<li>I bought a raspbery pi</li>
</ol>
<p>I bought a kit kinda like <a href="https://www.adafruit.com/product/3058" target="_blank" rel="noopener">this</a> that has a charger, case, some heat syncs, an SD card, and some other stuff that is needed to do much with the pi.</p>
<ol start="2">
<li>It sat in a drawer for 4 years. </li>
</ol>
<p>I don’t recommend following this step!</p>
<ol start="3">
<li>I finally decided to take it out and set it up.</li>
</ol>
<p>It is easiest to do this if you have a usb keyboard/mouse and monitor with HDMI cable. I tried before with a headless setup, and while there are instructions for that, sometimes troubleshooting is easier if you can see the pi’s homescreen.</p>
<ol start="4">
<li>Read a little about TOR relays</li>
</ol>
<p>The “Deciding to run a relay” section on the <a href="https://trac.torproject.org/projects/tor/wiki/TorRelayGuide" target="_blank" rel="noopener">Tor Relay Guide</a> is a great resource to understand what you are doing and why.</p>
<ol start="5">
<li>Install an OS on the raspberry pi (if it doesn’t have one already).</li>
</ol>
<p>Plug it in to let it boot up if you’re not sure. If it doesn’t boot up, you’ll probably need to write an OS to your SD card.</p>
<p>Here are instructions on <a href="https://www.raspberrypi.org/downloads/" target="_blank" rel="noopener">installing the OS</a>, which you can make CLI only/headless later if you want.</p>
<p>If you would perfer a minimal installation, the first part of this <a href="https://3os.org/raspberryPi/TOR-Pi/" target="_blank" rel="noopener">Headless tutorial</a> will show you how to install the minimal OS if you’re interested in that route. The rest of these instructions can also be followed using SSH on the cli.</p>
<ol start="6">
<li>Setup a static IP with your router</li>
</ol>
<p>This is important for port forwarding, or how your going to get the TOR traffic through your router and to the raspberry pi. Here are instructions on <a href="https://pimylifeup.com/raspberry-pi-static-ip-address/" target="_blank" rel="noopener">setting up a static IP on the raspberry pi’s OK</a>.</p>
<p>Make sure you are reserving the IP for your raspberry pi on your router. I had an issue with this.  This will be different on different routers, so you should just google ‘reserve static ip’ for your particular router model.</p>
<p>Also make sure to test your internet connection after this step by opening a webpage, running <code>ping google.com</code>, or something else.</p>
<ol start="7">
<li>Open ports 443 and 8080 on your router and forward to the static ip of your raspbery pi.</li>
</ol>
<p>This will again be different for different routers, so google ‘port forwarding’ for your router model.</p>
<ol start="8">
<li>Run these scripts</li>
</ol>
<p>You could just follow the official Tor <a href="https://trac.torproject.org/projects/tor/wiki/TorRelayGuide#Parttwo:technicalsetup" target="_blank" rel="noopener">documentation</a>, but these <a href="https://www.linux.com/news/turn-your-raspberry-pi-tor-relay-node/" target="_blank" rel="noopener">scripts</a> set up several other things for you like updating your system, ensuring automatic updates, and configuring the ports. Make sure you read through the <code>bootstrap.sh</code> after you clone that repo so that you exactly know what you are executing on your pi.</p>
<p>Make sure you follow the instructiosn about limiting the bandwidth, or the relay may take up all your bandwidth and make your network slow. The default settings already limit the bandwidth, but you may want to follow the instructions on the <a href="https://www.linux.com/news/turn-your-raspberry-pi-tor-relay-node/" target="_blank" rel="noopener">scripts</a> page to customize it for your connection.</p>
<p>Note: the address you add to the torrc file is published, so I used a <a href="https://relay.firefox.com/accounts/profile/" target="_blank" rel="noopener">Firefox relay address</a> instead of my main address.</p>
<ol start="9">
<li>Check the logs to make sure it is working!</li>
</ol>
<p>If you <code>tail /var/log/tor/notices.log</code>, you should see</p>
<p><code>Self-testing indicates your ORPort is reachable from the outside. Excellent. Publishing server descriptor.</code></p>
<p>If you see another message, the service may still be coming up. If you see a notice that it can’t reach the ports, then there is probably an issue with your port forwarding.</p>
<ol start="11">
<li>nyx</li>
</ol>
<p>You can use Tor <a href="https://nyx.torproject.org/" target="_blank" rel="noopener">Nyx</a> to monitor Tor. In order for it to work, you’ll need to add this to your <code>torrc</code> file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ControlPort 9051</span><br><span class="line">CookieAuthentication 1</span><br><span class="line">CookieAuthFileGroupReadable 1</span><br><span class="line">DataDirectoryGroupReadable 1</span><br></pre></td></tr></table></figure>

<p>And you’ll need to <a href="https://tor.stackexchange.com/questions/21109/debian-tor-vs-user" target="_blank" rel="noopener">add your logged in user to the debian-tor group</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -a -G debian-tor your_default_user</span><br></pre></td></tr></table></figure>

<p>Use <code>getent group debian-tor</code> to make sure the user is showing up in the groups. You will need to restart tor and possibly log in and out of the user.</p>
<ol start="12">
<li>Look up your relay in the registry</li>
</ol>
<p>In about 3 hours, your relay should be listed in the registry. In the <a href="https://metrics.torproject.org/rs.html" target="_blank" rel="noopener">Relay Search</a>, you can search by ip or nickname of your node.</p>
<p><a href="https://metrics.torproject.org/rs.html#details/7DADCE22CFB595E235C55F9F285CFE440802BE65" target="_blank" rel="noopener">Here’s mine!</a></p>
<ol start="13">
<li>Probably set up SSH so you can log in to your</li>
</ol>
<p><a href="https://www.raspberrypi.org/documentation/remote-access/ssh/" target="_blank" rel="noopener">Set up SSH on the raspberry pi</a> so you can access it using <code>ssh pi@&lt;static ip address&gt;</code> from a terminal on your computer</p>
<p><a href="https://3os.org/linux/SSH_Service_Security/#ssh_service_security" target="_blank" rel="noopener">Generate a public key and copy it to the pi</a></p>
<p>When I was done, I also went into the raspberry pi settings and switched it to boot up to CLI instead of desktop, since I will be running it without a monitor from now on.rap</p>
<p>And that’s it. I hope you try it out! Happy Torring!</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/posts/">Writing</a></li>
         
          <li><a href="http://github.com/kendallcorner" target="_blank" rel="noopener">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/" target="_blank" rel="noopener"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&text=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&is_video=false&description=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Start a TOR relay at home on a Raspberry Pi&body=Check out this article: http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&title=Start a TOR relay at home on a Raspberry Pi" target="_blank" rel="noopener"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/&name=Start a TOR relay at home on a Raspberry Pi&description=" target="_blank" rel="noopener"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Kendall Werts
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/posts/">Writing</a></li>
         
          <li><a href="http://github.com/kendallcorner" target="_blank" rel="noopener">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<link rel="stylesheet" href="/lib/meslo-LG/styles.css">


<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>



    <!-- Google Analytics -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-33031016-1', 'auto');
        ga('send', 'pageview');
    </script>



