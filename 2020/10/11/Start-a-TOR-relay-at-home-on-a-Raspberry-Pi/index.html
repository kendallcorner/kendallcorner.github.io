<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Start a TOR relay at home on a Raspberry Pi"><meta name="keywords" content=""><meta name="author" content="Kendall Werts"><meta name="copyright" content="Kendall Werts"><title>Start a TOR relay at home on a Raspberry Pi | kendallcorner</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.8.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.8.2"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="kendallcorner" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-I-bought-a-raspbery-pi"><span class="toc-number">1.</span> <span class="toc-text">1. I bought a raspbery pi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-It-sat-in-a-drawer-for-4-years"><span class="toc-number">2.</span> <span class="toc-text">2. It sat in a drawer for 4 years.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-I-finally-decided-to-take-it-out-and-set-it-up"><span class="toc-number">3.</span> <span class="toc-text">3. I finally decided to take it out and set it up.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Read-a-little-about-TOR-relays"><span class="toc-number">4.</span> <span class="toc-text">4. Read a little about TOR relays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Install-an-OS-on-the-raspberry-pi-if-it-doesn%E2%80%99t-have-one-already"><span class="toc-number">5.</span> <span class="toc-text">5. Install an OS on the raspberry pi (if it doesn’t have one already).</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Setup-a-static-IP-with-your-router"><span class="toc-number">6.</span> <span class="toc-text">6. Setup a static IP with your router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Open-ports-443-and-8080-on-your-router-and-forward-to-the-static-ip-of-your-raspbery-pi"><span class="toc-number">7.</span> <span class="toc-text">7. Open ports 443 and 8080 on your router and forward to the static ip of your raspbery pi.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Run-these-scripts"><span class="toc-number">8.</span> <span class="toc-text">8. Run these scripts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-Check-the-logs-to-make-sure-it-is-working"><span class="toc-number">9.</span> <span class="toc-text">9. Check the logs to make sure it is working!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-setup-nyx"><span class="toc-number">10.</span> <span class="toc-text">10. setup nyx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Look-up-your-relay-in-the-registry"><span class="toc-number">11.</span> <span class="toc-text">12. Look up your relay in the registry</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Probably-set-up-SSH-so-you-can-log-in-to-your-pi-and-check-on-it"><span class="toc-number">12.</span> <span class="toc-text">13. Probably set up SSH so you can log in to your pi and check on it</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Kendall Werts</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">7</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">3</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">kendallcorner</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">Start a TOR relay at home on a Raspberry Pi</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-10-11</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>I recently created a TOR relay on a raspberry pi at home. It sits quietly next to my router supporting free speech and privacy and costing me nothing daily.</p>
<p>Here’s how I did it.</p>
<h3 id="1-I-bought-a-raspbery-pi"><a href="#1-I-bought-a-raspbery-pi" class="headerlink" title="1. I bought a raspbery pi"></a>1. I bought a raspbery pi</h3><p>I bought a kit kinda like <a target="_blank" rel="noopener" href="https://www.adafruit.com/product/3058">this</a> that has a charger, case, some heat syncs, an SD card, and some other stuff that is needed to do much with the pi.</p>
<h3 id="2-It-sat-in-a-drawer-for-4-years"><a href="#2-It-sat-in-a-drawer-for-4-years" class="headerlink" title="2. It sat in a drawer for 4 years."></a>2. It sat in a drawer for 4 years.</h3><p>I don’t recommend following this step!</p>
<h3 id="3-I-finally-decided-to-take-it-out-and-set-it-up"><a href="#3-I-finally-decided-to-take-it-out-and-set-it-up" class="headerlink" title="3. I finally decided to take it out and set it up."></a>3. I finally decided to take it out and set it up.</h3><p>It is easiest to do this if you have a usb keyboard/mouse and monitor with HDMI cable. I tried before with a headless setup, and while there are instructions for that, sometimes troubleshooting is easier if you can see the pi’s homescreen.</p>
<h3 id="4-Read-a-little-about-TOR-relays"><a href="#4-Read-a-little-about-TOR-relays" class="headerlink" title="4. Read a little about TOR relays"></a>4. Read a little about TOR relays</h3><p>The “Deciding to run a relay” section on the <a target="_blank" rel="noopener" href="https://trac.torproject.org/projects/tor/wiki/TorRelayGuide">Tor Relay Guide</a> is a great resource to understand what you are doing and why.</p>
<h3 id="5-Install-an-OS-on-the-raspberry-pi-if-it-doesn’t-have-one-already"><a href="#5-Install-an-OS-on-the-raspberry-pi-if-it-doesn’t-have-one-already" class="headerlink" title="5. Install an OS on the raspberry pi (if it doesn’t have one already)."></a>5. Install an OS on the raspberry pi (if it doesn’t have one already).</h3><p>Plug it in to let it boot up if you’re not sure. If it doesn’t boot up, you’ll probably need to write an OS to your SD card.</p>
<p>Here are instructions on <a target="_blank" rel="noopener" href="https://www.raspberrypi.org/downloads/">installing the OS</a>, which you can make CLI only/headless later if you want.</p>
<p>If you would perfer a minimal installation, the first part of this <a target="_blank" rel="noopener" href="https://3os.org/raspberryPi/TOR-Pi/">Headless tutorial</a> will show you how to install the minimal OS if you’re interested in that route. The rest of these instructions can also be followed using SSH on the cli.</p>
<h3 id="6-Setup-a-static-IP-with-your-router"><a href="#6-Setup-a-static-IP-with-your-router" class="headerlink" title="6. Setup a static IP with your router"></a>6. Setup a static IP with your router</h3><p>This is important for port forwarding, or how your going to get the TOR traffic through your router and to the raspberry pi. Here are instructions on <a target="_blank" rel="noopener" href="https://pimylifeup.com/raspberry-pi-static-ip-address/">setting up a static IP on the raspberry pi’s OK</a>.</p>
<p>Make sure you are reserving the IP for your raspberry pi on your router. I had an issue with this.  This will be different on different routers, so you should just google ‘reserve static ip’ for your particular router model.</p>
<p>Also make sure to test your internet connection after this step by opening a webpage, running <code>ping google.com</code>, or something else.</p>
<h3 id="7-Open-ports-443-and-8080-on-your-router-and-forward-to-the-static-ip-of-your-raspbery-pi"><a href="#7-Open-ports-443-and-8080-on-your-router-and-forward-to-the-static-ip-of-your-raspbery-pi" class="headerlink" title="7. Open ports 443 and 8080 on your router and forward to the static ip of your raspbery pi."></a>7. Open ports 443 and 8080 on your router and forward to the static ip of your raspbery pi.</h3><p>This will again be different for different routers, so google ‘port forwarding’ for your router model.</p>
<h3 id="8-Run-these-scripts"><a href="#8-Run-these-scripts" class="headerlink" title="8. Run these scripts"></a>8. Run these scripts</h3><p>You could just follow the official Tor <a target="_blank" rel="noopener" href="https://trac.torproject.org/projects/tor/wiki/TorRelayGuide#Parttwo:technicalsetup">documentation</a>, but these <a target="_blank" rel="noopener" href="https://www.linux.com/news/turn-your-raspberry-pi-tor-relay-node/">scripts</a> set up several other things for you like updating your system, ensuring automatic updates, and configuring the ports. Make sure you read through the <code>bootstrap.sh</code> after you clone that repo so that you exactly know what you are executing on your pi.</p>
<p>Make sure you follow the instructiosn about limiting the bandwidth, or the relay may take up all your bandwidth and make your network slow. The default settings already limit the bandwidth, but you may want to follow the instructions on the <a target="_blank" rel="noopener" href="https://www.linux.com/news/turn-your-raspberry-pi-tor-relay-node/">scripts</a> page to customize it for your connection.</p>
<p>Note: the address you add to the torrc file is published, so I used a <a target="_blank" rel="noopener" href="https://relay.firefox.com/accounts/profile/">Firefox relay address</a> instead of my main address.</p>
<h3 id="9-Check-the-logs-to-make-sure-it-is-working"><a href="#9-Check-the-logs-to-make-sure-it-is-working" class="headerlink" title="9. Check the logs to make sure it is working!"></a>9. Check the logs to make sure it is working!</h3><p>If you <code>tail /var/log/tor/notices.log</code>, you should see</p>
<p><code>Self-testing indicates your ORPort is reachable from the outside. Excellent. Publishing server descriptor.</code></p>
<p>If you see another message, the service may still be coming up. If you see a notice that it can’t reach the ports, then there is probably an issue with your port forwarding.</p>
<h3 id="10-setup-nyx"><a href="#10-setup-nyx" class="headerlink" title="10. setup nyx"></a>10. setup nyx</h3><p>You can use Tor <a target="_blank" rel="noopener" href="https://nyx.torproject.org/">Nyx</a> to monitor Tor. In order for it to work, you’ll need to add this to your <code>torrc</code> file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ControlPort 9051</span><br><span class="line">CookieAuthentication 1</span><br><span class="line">CookieAuthFileGroupReadable 1</span><br><span class="line">DataDirectoryGroupReadable 1</span><br></pre></td></tr></table></figure>

<p>And you’ll need to <a target="_blank" rel="noopener" href="https://tor.stackexchange.com/questions/21109/debian-tor-vs-user">add your logged in user to the debian-tor group</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -a -G debian-tor your_default_user</span><br></pre></td></tr></table></figure>

<p>Use <code>getent group debian-tor</code> to make sure the user is showing up in the groups. You will need to restart tor and possibly log in and out of the user.</p>
<h3 id="12-Look-up-your-relay-in-the-registry"><a href="#12-Look-up-your-relay-in-the-registry" class="headerlink" title="12. Look up your relay in the registry"></a>12. Look up your relay in the registry</h3><p>In about 3 hours, your relay should be listed in the registry. In the <a target="_blank" rel="noopener" href="https://metrics.torproject.org/rs.html">Relay Search</a>, you can search by ip or nickname of your node.</p>
<p><a target="_blank" rel="noopener" href="https://metrics.torproject.org/rs.html#details/7DADCE22CFB595E235C55F9F285CFE440802BE65">Here’s mine!</a></p>
<h3 id="13-Probably-set-up-SSH-so-you-can-log-in-to-your-pi-and-check-on-it"><a href="#13-Probably-set-up-SSH-so-you-can-log-in-to-your-pi-and-check-on-it" class="headerlink" title="13. Probably set up SSH so you can log in to your pi and check on it"></a>13. Probably set up SSH so you can log in to your pi and check on it</h3><p><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/documentation/remote-access/ssh/">Set up SSH on the raspberry pi</a> so you can access it using <code>ssh pi@&lt;static ip address&gt;</code> from a terminal on your computer</p>
<p><a target="_blank" rel="noopener" href="https://3os.org/linux/SSH_Service_Security/#ssh_service_security">Generate a public key and copy it to the pi</a></p>
<p>When I was done, I also went into the raspberry pi settings and switched it to boot up to CLI instead of desktop, since I will be running it without a monitor from now on.rap</p>
<p>And that’s it. I hope you try it out! Happy Torring!</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Kendall Werts</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/">http://kendallcorner.com/2020/10/11/Start-a-TOR-relay-at-home-on-a-Raspberry-Pi/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="next-post pull-right"><a href="/2019/12/29/Mozilla-HG/"><span>Useful Mercurial Commands for Mozilla Central</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By Kendall Werts</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.8.2"></script><script src="/js/fancybox.js?version=1.8.2"></script><script src="/js/sidebar.js?version=1.8.2"></script><script src="/js/copy.js?version=1.8.2"></script><script src="/js/fireworks.js?version=1.8.2"></script><script src="/js/transition.js?version=1.8.2"></script><script src="/js/scroll.js?version=1.8.2"></script><script src="/js/head.js?version=1.8.2"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>